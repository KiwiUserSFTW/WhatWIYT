{"ast":null,"code":"import _toConsumableArray from\"C:/Users/danie/OneDrive/Desktop/WWIYT/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/danie/OneDrive/Desktop/WWIYT/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{MapsActionTypes}from\"../../types/maps\";// Todo update DEFAULT_CITY TO ARR INIT LOCAL STR\nvar DEFAULT_CITY=703448;var savedCityCodes=localStorage.getItem('CityCodes');var getInitialCityCodes=function getInitialCityCodes(){if(!savedCityCodes||!JSON.parse(savedCityCodes)){return[DEFAULT_CITY];}return JSON.parse(savedCityCodes);};var initialState={data:[],codes:getInitialCityCodes(),loading:false,error:null};export var mapsReducer=function mapsReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case MapsActionTypes.FETCH_MAPS:return _objectSpread(_objectSpread({},state),{},{loading:true});case MapsActionTypes.FETCH_MAPS_SUCCESS:return _objectSpread(_objectSpread({},state),{},{loading:false,data:action.payload});case MapsActionTypes.FETCH_MAPS_ERROR:return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});case MapsActionTypes.ADD_MAP:if(state.codes.includes(action.payload)){return state;}var updatedCodes=[].concat(_toConsumableArray(state.codes),[action.payload]);localStorage.setItem('CityCodes',JSON.stringify(updatedCodes));return _objectSpread(_objectSpread({},state),{},{codes:updatedCodes});case MapsActionTypes.DELETE_MAP:// Todo: refilter\nvar updatedCodesAfterRemove=state.codes.reduce(function(arr,e){if(e!=action.payload){arr.push(e);}return arr;},[]);localStorage.setItem('CityCodes',JSON.stringify(updatedCodesAfterRemove));return _objectSpread(_objectSpread({},state),{},{loading:false,codes:updatedCodesAfterRemove});default:return state;}};","map":{"version":3,"names":["MapsActionTypes","DEFAULT_CITY","savedCityCodes","localStorage","getItem","getInitialCityCodes","JSON","parse","initialState","data","codes","loading","error","mapsReducer","state","arguments","length","undefined","action","type","FETCH_MAPS","_objectSpread","FETCH_MAPS_SUCCESS","payload","FETCH_MAPS_ERROR","ADD_MAP","includes","updatedCodes","concat","_toConsumableArray","setItem","stringify","DELETE_MAP","updatedCodesAfterRemove","reduce","arr","e","push"],"sources":["C:/Users/danie/OneDrive/Desktop/WWIYT/src/store/reducers/mapsReducers.ts"],"sourcesContent":["import { MapsActionTypes, MapsState } from \"../../types/maps\"\r\nimport { MapsAction } from \"../../types/maps\"\r\n// Todo update DEFAULT_CITY TO ARR INIT LOCAL STR\r\nconst DEFAULT_CITY = 703448;\r\nconst savedCityCodes = localStorage.getItem('CityCodes');\r\nconst getInitialCityCodes = ():number[] => {\r\n    if(!savedCityCodes || !JSON.parse(savedCityCodes)) {\r\n        return [DEFAULT_CITY]\r\n    }\r\n    return JSON.parse(savedCityCodes)\r\n}\r\n\r\nconst initialState: MapsState = {\r\n    data: [],\r\n    codes:getInitialCityCodes(),\r\n    loading:false,\r\n    error:null\r\n}\r\n\r\nexport const mapsReducer = (state:MapsState = initialState, action:MapsAction): MapsState => {\r\n    switch (action.type){\r\n        case MapsActionTypes.FETCH_MAPS:\r\n            return {...state, loading:true}\r\n        case MapsActionTypes.FETCH_MAPS_SUCCESS:\r\n            return {...state, loading:false, data: action.payload}\r\n        case MapsActionTypes.FETCH_MAPS_ERROR:\r\n            return {...state, loading:false, error: action.payload}\r\n        case MapsActionTypes.ADD_MAP:\r\n            if(state.codes.includes(action.payload)){\r\n                return state\r\n            }\r\n            const updatedCodes = [...state.codes, action.payload];\r\n            localStorage.setItem('CityCodes', JSON.stringify(updatedCodes));\r\n            return {...state, codes:updatedCodes}\r\n        case MapsActionTypes.DELETE_MAP:\r\n            // Todo: refilter\r\n            const updatedCodesAfterRemove = state.codes.reduce((arr:number[], e) => {\r\n            if(e != action.payload) {\r\n                arr.push(e);\r\n            }\r\n            return arr;\r\n            }, [])\r\n            localStorage.setItem('CityCodes', JSON.stringify(updatedCodesAfterRemove))\r\n            return {...state, loading:false, codes: updatedCodesAfterRemove}\r\n        \r\n        default:\r\n            return state;\r\n    }\r\n}"],"mappings":"6PAAA,OAASA,eAAe,KAAmB,kBAAkB,CAE7D;AACA,GAAM,CAAAC,YAAY,CAAG,MAAM,CAC3B,GAAM,CAAAC,cAAc,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CACxD,GAAM,CAAAC,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CAAA,CAAkB,CACvC,GAAG,CAACH,cAAc,EAAI,CAACI,IAAI,CAACC,KAAK,CAACL,cAAc,CAAC,CAAE,CAC/C,MAAO,CAACD,YAAY,CAAC,CACzB,CACA,MAAO,CAAAK,IAAI,CAACC,KAAK,CAACL,cAAc,CAAC,CACrC,CAAC,CAED,GAAM,CAAAM,YAAuB,CAAG,CAC5BC,IAAI,CAAE,EAAE,CACRC,KAAK,CAACL,mBAAmB,CAAC,CAAC,CAC3BM,OAAO,CAAC,KAAK,CACbC,KAAK,CAAC,IACV,CAAC,CAED,MAAO,IAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAqE,IAAjE,CAAAC,KAAe,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAGP,YAAY,IAAE,CAAAU,MAAiB,CAAAH,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,CACzE,OAAQC,MAAM,CAACC,IAAI,EACf,IAAK,CAAAnB,eAAe,CAACoB,UAAU,CAC3B,OAAAC,aAAA,CAAAA,aAAA,IAAWP,KAAK,MAAEH,OAAO,CAAC,IAAI,GAClC,IAAK,CAAAX,eAAe,CAACsB,kBAAkB,CACnC,OAAAD,aAAA,CAAAA,aAAA,IAAWP,KAAK,MAAEH,OAAO,CAAC,KAAK,CAAEF,IAAI,CAAES,MAAM,CAACK,OAAO,GACzD,IAAK,CAAAvB,eAAe,CAACwB,gBAAgB,CACjC,OAAAH,aAAA,CAAAA,aAAA,IAAWP,KAAK,MAAEH,OAAO,CAAC,KAAK,CAAEC,KAAK,CAAEM,MAAM,CAACK,OAAO,GAC1D,IAAK,CAAAvB,eAAe,CAACyB,OAAO,CACxB,GAAGX,KAAK,CAACJ,KAAK,CAACgB,QAAQ,CAACR,MAAM,CAACK,OAAO,CAAC,CAAC,CACpC,MAAO,CAAAT,KAAK,CAChB,CACA,GAAM,CAAAa,YAAY,IAAAC,MAAA,CAAAC,kBAAA,CAAOf,KAAK,CAACJ,KAAK,GAAEQ,MAAM,CAACK,OAAO,EAAC,CACrDpB,YAAY,CAAC2B,OAAO,CAAC,WAAW,CAAExB,IAAI,CAACyB,SAAS,CAACJ,YAAY,CAAC,CAAC,CAC/D,OAAAN,aAAA,CAAAA,aAAA,IAAWP,KAAK,MAAEJ,KAAK,CAACiB,YAAY,GACxC,IAAK,CAAA3B,eAAe,CAACgC,UAAU,CAC3B;AACA,GAAM,CAAAC,uBAAuB,CAAGnB,KAAK,CAACJ,KAAK,CAACwB,MAAM,CAAC,SAACC,GAAY,CAAEC,CAAC,CAAK,CACxE,GAAGA,CAAC,EAAIlB,MAAM,CAACK,OAAO,CAAE,CACpBY,GAAG,CAACE,IAAI,CAACD,CAAC,CAAC,CACf,CACA,MAAO,CAAAD,GAAG,CACV,CAAC,CAAE,EAAE,CAAC,CACNhC,YAAY,CAAC2B,OAAO,CAAC,WAAW,CAAExB,IAAI,CAACyB,SAAS,CAACE,uBAAuB,CAAC,CAAC,CAC1E,OAAAZ,aAAA,CAAAA,aAAA,IAAWP,KAAK,MAAEH,OAAO,CAAC,KAAK,CAAED,KAAK,CAAEuB,uBAAuB,GAEnE,QACI,MAAO,CAAAnB,KAAK,CACpB,CACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}